<html>
	<header>
		<link rel="stylesheet" href="semantic/semantic.min.css">
	</header>
	<body>
		
    <div class="ui top fixed menu">
        <div class="item">
            <img src="img/logo.png">
        </div>
        <a class="item">Enquete</a>
        <a class="right item">Sobre</a>
    </div><br><br>
		<h1 class="ui centered aligned header">Em quem você vota para presidente do Brasil em 2018?</h1>
		
		<div class="ui centered aligned header blue" id="msg" style="display:none">
			<br>
			<h2><b></b></h2>
		</div>
		
    <div class="ui stackable four column grid doubling container segment row link cards" id="candidates" style="display:none">
        <div class="column">
            <div class="ui centered card" data-id="1">
                <div class="image dimmable">
                    <div class="ui yellow ribbon label">
                        <i class="star icon"></i> PDT
                    </div>
                    <div class="ui blurring inverted dimmer transition hidden">
                        <div class="content">
                          <div class="center">
                            <div class="ui teal button">Add Friend</div>
                          </div>
                        </div>
                    </div>
                    <img src="img/ciro-gomes.jpg">
                </div>
                <div class="content">
                    <a class="header name">CIRO GOMES</a>
                    <div class="meta">
                        <span class="date">06/11/1957</span>
                    </div>
                    <div class="description">
                      Ciro Ferreira Gomes, de 60 anos, nasceu em Pindamonhangaba (SP), mas mudou-se ainda criança para Sobral (CE). É formado em Direito pela Universidade Federal do Ceará.
                    </div>
                </div>
                <div class="extra content">
                    <a><i class="user icon"></i>
                        Ex-Governador, Advogado.
                    </a>
                </div>
            </div>
        </div>
        <div class="column">
            <div class="ui centered card" data-id="2">
                <div class="image">
                    <div class="ui black ribbon label">
                        <i class="star icon"></i> PSL
                    </div>
                    <img src="img/jair-bolsonaro.jpg">
                </div>
                <div class="content">
                    <a class="header name">JAIR BOLSONARO</a>
                    <div class="meta">
                        <span class="date">21/03/1955</span>
                    </div>
                    <div class="description">
                       Deputado federal em seu sétimo mandato, Jair Bolsonaro não é um iniciante na política. Militar da reserva, ele vem ganhando espaço no cenário nacional e consolidando ...
                    </div>
                </div>
                <div class="extra content">
                    <a><i class="user icon"></i>
                        Deputado Federal, Ex-Militar.
                    </a>
                </div>
            </div>
        </div>
        <div class="column">
            <div class="ui centered card" data-id="3">
                <div class="image">
                    <div class="ui blue ribbon label">
                        <i class="star icon"></i> NOVO
                    </div>
                    <img src="img/joao-amoedo.jpg">
                </div>
                <div class="content">
                    <a class="header name">JOÃO AMOEDO</a>
                    <div class="meta">
                        <span class="date">22/10/1962</span>
                    </div>
                    <div class="description">
                       João Amoêdo é formado em administração de empresas e em engenharia e já atuou em diversas instituições financeiras. Atualmente é membro do Conselho de ...
                    </div>
                </div>
                <div class="extra content">
                    <a><i class="user icon"></i>
                       Fundador do Novo, Empresário.
                    </a>
                </div>
            </div>
        </div>
        <div class="column">
            <div class="ui centered card" data-id="4">
                <div class="image">
                    <div class="ui green ribbon label">
                        <i class="star icon"></i> REDE
                    </div>
                    <img src="img/marina-silva.jpg">
                </div>
                <div class="content">
                    <a class="header name">MARINA SILVA</a>
                    <div class="meta">
                        <span class="date">08/02/1958</span>
                    </div>
                    <div class="description">
                       Maria Osmarina Marina Silva Vaz de Lima, 59 anos. É filha de um seringueiro e uma dona de casa. Viveu até os 15 anos numa palafita. Alfabetizou-se aos 16 anos...
                    </div>
                </div>
                <div class="extra content">
                    <a><i class="user icon"></i>
                        Ex-senadora, Historiadora.
                    </a>
                </div>
            </div>
        </div>
    </div>
		<br><br><br><br>
		<div class="ui segment grid container" id="result"  style="display:none">
            <h1 class="ui centered aligned header row">Resultado Atual</h1>
			 <div class="ui ordered horizontal center aligned list sixteen wide column">
              <div class="item">
                <img class="ui avatar image" src="img/geraldo-alckmin.jpg">
                <div class="content">
                  <div class="header">Steve Jobes</div>
                  50 Votos
                </div>
              </div>
              <div class="item">
                <img class="ui avatar image" src="img/alvaro-dias.jpg">
                <div class="content">
                  <div class="header">Stevie Feliciano</div>
                  44 Votos
                </div>
              </div>
              <div class="item">
                <img class="ui avatar image" src="img/guilherme-boulos.jpg">
                <div class="content">
                  <div class="header">Jenny Hess</div>
                  11 Votos
                </div>
              </div>
                <div class="item">
                <img class="ui avatar image" src="img/joao-amoedo.jpg">
                <div class="content">
                  <div class="header">Jenny Hess</div>
                  11 Votos
                </div>
              </div><br><br>
            </div>   
		</div>

    <br><br><br>
        
        
    <div class="ui basic test modal">
        <div>
           <img class="ui medium centered circular image" id="modalImg" src="">
        </div>
        <div class="ui center aligned header">
          <h1>Você vota em <b id="modalName"></b>?</h1>
        </div>
        <div class="actions" style="text-align:center;">
          <div class="massive ui red basic cancel inverted button">
            <i class="remove icon"></i>
            Cancela
          </div>
          <div class="massive ui green ok inverted button" id="voteBtn">
            <i class="checkmark icon"></i>
            Confirma
          </div>
        </div>
    </div>

<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="semantic/semantic.min.js" type="text/javascript"></script>
		
		
<script> 
var ipGlobal = null;

$.getJSON('https://api.ipify.org?format=jsonp&callback=?', function(data) {
	ipGlobal = data.ip;
	console.log(".:: Using IP: "+data.ip+" ::.");
	$.ajax({
		url: '/checkip/'+data.ip,
		complete: function(data) {
			if(data.responseText){
				$("#result").css('display','block');
				$("#msg").css('display','block');
				$("#msg b").html("Um voto já foi efetuado com esse IP em: "+data.responseText);
			} else{
				$("#candidates").css('display','flex');
				console.log("Apto a Votar!");
			}
		}
	});
});

$(".card").click(function(){
	var id = $(this).attr("data-id");
	var img = $(this).find('img').attr('src');
	var name = $(this).find('.name').html();
	$("#modalImg").attr('src', img);
	$("#modalName").html(name);
	$('#voteBtn').attr("data-id", id);
	//Open modal
	$('.ui.basic.test.modal')
			.modal({
				blurring: true,
				closable  : true,
				onDeny    : function(){
					console.log("Cancelou!");;
				},
				onApprove : function() {
					 console.log("Votou!");
				}
			}).modal('show');
});

$("#voteBtn").click(function(){
	var id = $(this).attr("data-id");
	$.ajax({
		url: '/setip/'+ipGlobal,
		complete: function(data) {
			$("#candidates").css('display','none');
			$("#result").css('display','block');
		}
	});	
});


$.ajax({
  url: '/candidates',
  complete: function(data) {
    console.log(data.responseJSON.id.name);
  }
});

</script>
		
	</body>
</html>
